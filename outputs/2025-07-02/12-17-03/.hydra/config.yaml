datamodule:
  _target_: datamodule.goose_dataset.GooseDataModule
  root: /home/autokarthik/autoware.off-road/goose-dataset
  batch_size: 4
  num_workers: 8
  num_classes: 12
  img_size:
  - 512
  - 512
  scale_base:
  - 2048
  - 512
  ratio_range:
  - 0.5
  - 2.0
  mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
model:
  _target_: models.segformer.segformer.LitSegFormer
  variant: B2
  num_classes: ${datamodule.num_classes}
  lr: ${optim.optimizer.lr}
  weight_decay: ${optim.optimizer.weight_decay}
  optim_config: ${optim.optimizer}
  lr_scheduler_config: ${optim.scheduler}
optim:
  optimizer:
    _target_: torch.optim.AdamW
    _partial_: true
    lr: 6.0e-05
    weight_decay: 0.01
  scheduler:
    _target_: torch.optim.lr_scheduler.PolynomialLR
    _partial_: true
    total_iters: 160000
    power: 1.0
trainer:
  _target_: lightning.pytorch.Trainer
  max_epochs: 80
  accelerator: auto
  devices: auto
  precision: bf16-mixed
  strategy:
    _target_: ray.train.lightning.RayDDPStrategy
  plugins:
  - _target_: ray.train.lightning.RayLightningEnvironment
logger:
  _target_: lightning.pytorch.loggers.MLFlowLogger
  experiment_name: SegFormer
  tracking_uri: file:${hydra:runtime.output_dir}/mlruns
  log_model: true
ray:
  _target_: ray.train.ScalingConfig
  num_workers: 1
  use_gpu: true
  resources_per_worker:
    CPU: 1
    GPU: 1
callbacks:
  _target_: ray.train.lightning.RayTrainReportCallback
  monitor: val_miou
  mode: max
  patience: 10
  save_top_k: 5
  save_last: true
  filename: segformer-{epoch:02d}-{val_miou:.4f}
  logging_interval: step
seed: 42
